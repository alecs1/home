/*
 * OpenTag, a tag deployment platform
 * Copyright 2011-2012, QuBit Group
 * http://opentag.qubitproducts.com
 */

try{(function(){(function(){function q(){}q.getUrl=function(){return document.location.href};q.getQueryParam=function(y){var t,u,x,s,w,r,v;s=q.getUrl();if(s.indexOf("?")>0){r=s.substring(s.indexOf("?")+1).split("&");for(t=0,u=r.length;t<u;t+=1){w=r[t];if(w.indexOf("=")>0){v=w.split("=");if((v.length===2)&&(v[0]===y)){return v[1]}}}}return null};q.variableExists=function(r){return(r!==undefined)&&(r!==null)};q.getElementValue=function(r){var s=document.getElementById(r);if(s){return s.textContent||s.innerText}return null};q.substituteArray=function(v,u,w){var x,r,t,s;t=v.value.indexOf("[#]");x=v.value.substring(0,t);r=v.value.substring(t+3);w=w.replace(new RegExp(u+"\\.length","g"),x+".length");w=w.replace(new RegExp(u+"(\\[.*?\\])","g"),x+"$1"+r);return w};q.prepareQuotedString=function(r){if(typeof(r)==="string"){return'"'+(r.replace(/\"/g,'\\"'))+'"'}else{return r}};q.namespace=function(x,r){var v=x.split(".");var w=(function(){return eval("this")}());var u=null,s=null;for(var t=0;t<v.length;t++){u=w;s=v[t];w[s]=w[s]||{};w=w[s]}if(r){u[s]=r}return u[s]};q.namespace("qubit.qtag");qubit.qtag.Utils=qubit.qtag.Utils||q;window.qubit.qtag=window.qubit.qtag||qubit.qtag}());var b={};b.html={};b.html.fileLoader={};b.html.fileLoader.load=function(q,z,B,x,u,v){var r,s,y,t,w;w=false;t=function(C){return function(){if(!w){w=true;if(C&&!y){y={url:document.location.href}}B(q,y,C)}}};try{if(z){s=z(q)}}catch(A){s=false;B(q,"Exception loading pre",true)}finally{if(s!==false){r=b.html.fileLoader.createScriptEl(q,u,false,v);if(B){r.onload=t(false);r.onerror=t(true);r.onreadystatechange=function(){if((this.readyState==="complete")||(this.readyState==="loaded")){setTimeout(function(){t(false)()},1)}}}if(!x){x=window.document.getElementsByTagName("head")[0]}x.appendChild(r)}}};b.html.fileLoader.createScriptEl=function(u,t,v,q){var r,s=document.createElement("script");s.type="text/javascript";s.src=b.html.fileLoader.tidyUrl(u)+(v?("?"+new Date().getTime()):"");if(t!==false){s.async="true";s.defer="true"}else{s.async="false";if(s.async!==false){s.async=false}s.defer="false"}for(r in q){if(q.hasOwnProperty(r)){s.setAttribute(r,q[r])}}return s};b.html.fileLoader.tidyUrl=function(q){if(q.substring(0,5)==="http:"){return q}if(q.substring(0,6)==="https:"){return q}return"//"+q};b.html.PostData=function(t,x,z){var y,v,B,u,s,A,w,r,C,q;q=2;C=5000;w=false;r=function(){if(q>0){setTimeout(function(){if(!w){q-=1;y()}},C)}};v=navigator.userAgent.toLowerCase();B=v.indexOf("msie")!==-1;u=v.indexOf("msie 9")!==-1;s=((v.indexOf("msie 7")!==-1)||(v.indexOf("msie 6")!==-1));A=("https:"===document.location.protocol?"https:":"http:")+t;z=z||"POST";y=function(){var I;try{I=null;try{I=new XMLHttpRequest()}catch(H){}if(I&&!B){I.open(z,A,true)}else{if(typeof XDomainRequest!=="undefined"){I=new XDomainRequest();I.open(z,A)}else{I=null}}try{I.withCredentials=false}catch(G){}if(I.setRequestHeader){I.setRequestHeader("Content-Type","text/plain;charset=UTF-8")}I.onload=function(){w=true};I.onreadystatechange=function(){};I.ontimeout=function(){};I.onerror=function(){};I.onprogress=function(){};I.send(x)}catch(E){try{try{b.html.fileLoader.load(A)}catch(D){if(window.console&&window.console.log){window.console.log(E)}}}catch(F){}}r()};if(s){b.html.fileLoader.load(A);return}else{y()}};b.html.GlobalEval={};b.html.GlobalEval.globalEval=function(r){if(window.execScript){window.execScript(r)}else{var q=function(){window["eval"].call(window,r)};q()}};b.html.HtmlInjector={};b.html.HtmlInjector.inject=function(q,z,y,t,w){var v,C,x,B,u,A,r;if(y.toLowerCase().indexOf("<script")>=0){x=document.createElement("div");x.innerHTML="a"+y;B=x.getElementsByTagName("script");u=[];for(v=0,C=B.length;v<C;v+=1){u.push(B[v])}r=[];for(v=0,C=u.length;v<C;v+=1){A=u[v];var D={attributes:b.html.HtmlInjector.getAttributes(A)};if(A.src){D.src=A.src}else{D.script=A.innerHTML}r.push(D);A.parentNode.removeChild(A)}if(x.innerHTML){if(x.innerHTML.length>0){x.innerHTML=x.innerHTML.substring(1)}}b.html.HtmlInjector.doInject(q,z,x);b.html.HtmlInjector.loadScripts(r,0,t,q)}else{x=document.createElement("div");x.innerHTML=y;b.html.HtmlInjector.doInject(q,z,x);if(t){t()}}};b.html.HtmlInjector.doInject=function(s,r,t){if(t.childNodes.length>0){var q=document.createDocumentFragment();while(t.childNodes.length>0){q.appendChild(t.removeChild(t.childNodes[0]))}if(r){b.html.HtmlInjector.injectAtStart(s,q)}else{b.html.HtmlInjector.injectAtEnd(s,q)}}};b.html.HtmlInjector.injectAtStart=function(r,q){if(r.childNodes.length===0){r.appendChild(q)}else{r.insertBefore(q,r.childNodes[0])}};b.html.HtmlInjector.injectAtEnd=function(s,r,q){if(!q){q=1}if((s===document.body)&&(document.readyState!=="complete")&&(q<50)){setTimeout(function(){b.html.HtmlInjector.injectAtEnd(s,r,q+1)},100)}else{s.appendChild(r)}};b.html.HtmlInjector.loadScripts=function(u,s,r,q){var t,w,v=false;for(t=u.length;s<t;s+=1){w=u[s];if(w.src){v=true;break}else{b.html.GlobalEval.globalEval(w.script)}}if(v){b.html.fileLoader.load(w.src,null,function(){b.html.HtmlInjector.loadScripts(u,s+1,r,q)},q,false,w.attributes)}if(r&&(s===t)){r()}};b.html.HtmlInjector.getAttributes=function(u){var q,t,r,w,s,v={};if(u){r=u.attributes;t=r.length;for(q=0;q<t;q++){w=r[q].value;s=r[q].name.toLowerCase();if((w!=="")&&((s==="id")||(s==="class")||(s==="charset")||(s.substr(0,5)==="data-"))){v[s]=w}}return v}};(function(){var s,u=false,w=1,v,r,t,q;r=function(y){var x;if(y===true){w-=1}if(!w||(y!==true&&!u)){if(!document.body){return setTimeout(r,1)}u=true;if(y!==true){w-=1;if(w>0){return}}while(v.length>0){x=v.shift();x()}}};q=function(){if(u){return}try{document.documentElement.doScroll("left")}catch(x){setTimeout(q,1);return}r()};t=function(){if(v){return}v=[];if(document.readyState==="complete"){return setTimeout(r,1)}if(document.addEventListener){document.addEventListener("DOMContentLoaded",s,false);window.addEventListener("load",r,false)}else{if(document.attachEvent){document.attachEvent("onreadystatechange",s);window.attachEvent("onload",r);var x=false;try{x=(window.frameElement===null)||(window.frameElement===undefined)}catch(y){}if(document.documentElement.doScroll&&x){q()}}}};b.html.ready=function(x){t();if(u){setTimeout(x,1)}else{v.push(x)}};if(document.addEventListener){s=function(){document.removeEventListener("DOMContentLoaded",s,false);r()}}else{if(document.attachEvent){s=function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",s);r()}}}}}());b.cookie={};b.cookie.PageView={};b.cookie.PageView.update=function(){var q,t;t=function s(){return(Math.floor(1+Math.random()*65536)).toString(36).substring(1)};if(!window.__pageViewId__){q=new Date().getTime().toString(36);window.__pageViewId__=q+t()+t()+t()}return window.__pageViewId__};b.html.simplecookie={};b.html.simplecookie.readCookie=function(q){var w,t,x,v,y,s,u;y=q+"=";v=document.cookie.split(";");w=/^\s+|\s+$/g;for(s=0,u=v.length;s<u;s+=1){t=v[s].replace(w,"");if(t.indexOf(y)===0){x=unescape(t.substring(y.length));if(x.length===0){return null}return x}}return null};b.html.simplecookie.readAllCookies=function(s){var q,t,v,x,z,u,y,w;z=s+"=";x=document.cookie.split(";");q=/^\s+|\s+$/g;w=[];for(u=0,y=x.length;u<y;u+=1){t=x[u].replace(q,"");if(t.indexOf(z)===0){v=unescape(t.substring(z.length));if(v.length>0){w.push(v)}}}return w};b.html.simplecookie.writeCookie=function(s,v,w,u){var r,q,t;if(w){r=new Date();r.setTime(r.getTime()+(w*86400000));q="; expires="+r.toGMTString()}else{q=""}t=escape(s)+"="+escape(v)+q+"; path=/;";if(u){t+=" domain="+u}document.cookie=t};var p={};(function(){function u(A){return A<10?"0"+A:A}var s=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,w=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,x,r,z={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},y;function q(A){w.lastIndex=0;return w.test(A)?'"'+A.replace(w,function(B){var C=z[B];return typeof C==="string"?C:"\\u"+("0000"+B.charCodeAt(0).toString(16)).slice(-4)
})+'"':'"'+A+'"'}function t(A){return isFinite(A.valueOf())?A.getUTCFullYear()+"-"+u(A.getUTCMonth()+1)+"-"+u(A.getUTCDate())+"T"+u(A.getUTCHours())+":"+u(A.getUTCMinutes())+":"+u(A.getUTCSeconds())+"Z":null}function v(H,E){var C,B,I,A,F=x,D,G=E[H];if(G instanceof Date){G=t(G)}else{if((G instanceof String)||(G instanceof Number)||(G instanceof Boolean)){G=G.valueOf()}}if(typeof y==="function"){G=y.call(E,H,G)}switch(typeof G){case"string":return q(G);case"number":return isFinite(G)?String(G):"null";case"boolean":case"null":return String(G);case"object":if(!G){return"null"}x+=r;D=[];if(Object.prototype.toString.apply(G)==="[object Array]"){A=G.length;for(C=0;C<A;C+=1){D[C]=v(C,G)||"null"}I=D.length===0?"[]":x?"[\n"+x+D.join(",\n"+x)+"\n"+F+"]":"["+D.join(",")+"]";x=F;return I}if(y&&typeof y==="object"){A=y.length;for(C=0;C<A;C+=1){if(typeof y[C]==="string"){B=y[C];I=v(B,G);if(I){D.push(q(B)+(x?": ":":")+I)}}}}else{for(B in G){if(Object.prototype.hasOwnProperty.call(G,B)){I=v(B,G);if(I){D.push(q(B)+(x?": ":":")+I)}}}}I=D.length===0?"{}":x?"{\n"+x+D.join(",\n"+x)+"\n"+F+"}":"{"+D.join(",")+"}";x=F;return I}}if(typeof p.stringify!=="function"){p.stringify=function(D,B,C){var A;x="";r="";if(typeof C==="number"){for(A=0;A<C;A+=1){r+=" "}}else{if(typeof C==="string"){r=C}}y=B;if(B&&typeof B!=="function"&&(typeof B!=="object"||typeof B.length!=="number")){throw new Error("JSON.stringify")}return v("",{"":D})}}if(typeof p.parse!=="function"){p.parse=function(D,A){var C;function B(H,G){var F,E,I=H[G];if(I&&typeof I==="object"){for(F in I){if(Object.prototype.hasOwnProperty.call(I,F)){E=B(I,F);if(E!==undefined){I[F]=E}else{delete I[F]}}}}return A.call(H,G,I)}D=String(D);s.lastIndex=0;if(s.test(D)){D=D.replace(s,function(E){return"\\u"+("0000"+E.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(D.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){C=eval("("+D+")");return typeof A==="function"?B({"":C},""):C}throw new SyntaxError("JSON.parse")}}}());(function(){function q(x){return x.replace(/^\s+/,"").replace(/\s+$/,"")}var u={callbacks:{},unfired_events:[],early_callbacks:null,currentUV:null},s,t="universal_variable",r=0,w=500,v;u._isArray=function(x){return(Object.prototype.toString.call(x)==="[object Array]")};u._targetChanged=function(y,x,z){var C,A,B;if(z===null){if(x==="null"){return false}else{return true}}else{if(z===undefined){if(x===z){return false}else{return true}}else{C=p.parse(x);A=u._getNested(C,y);B=u._getNested(z,y);return !u._jsonIsEqual(A,B)}}};u._processCallbacks=function(){var x;if(u.early_callbacks&&u.early_callbacks.length>0){for(x=0;x<u.early_callbacks.length;x+=1){u.push(u.early_callbacks[x])}u.early_callbacks=null}};u._keyStringToArr=function(x){x=q(x);if(x===""){return[]}else{x=x.replace(/\[(\w+)\]/g,".$1");x=x.replace(/^\./,"");return x.split(".")}};u._getNested=function(z,y){var x=u._keyStringToArr(y),A;while(x.length>0){A=x.shift();if(z.hasOwnProperty(A)){z=z[A]}else{return}}return z};u._jsonIsEqual=function(y,x){if(typeof y!=="string"){y=p.stringify(y,u._stripEvents)}if(typeof x!=="string"){x=p.stringify(x,u._stripEvents)}return y===x};u._stripEvents=function(x,y){if(x!=="events"){return y}else{return undefined}};u._on=function(y,z){var A,x;A=y.split(":");y=A[0];x=A[1];u.callbacks[y]=u.callbacks[y]||[];if(x){u.callbacks[y].push({keyString:x,func:z})}else{u.callbacks[y].push({func:z})}};u._trigger=function(z,A){var y,x;if(u.callbacks[z]){for(y=0;y<u.callbacks[z].length;y+=1){if(typeof u.callbacks[z][y].func==="function"){x=u.callbacks[z][y].keyString;if(x){if(z==="change"&&u._targetChanged(x,u.currentUV,s)){u.callbacks[z][y].func(A)}}else{u.callbacks[z][y].func(A)}}}}};u._eventsPush=function(x){var y,z;s.events[s.events.length]=x;x.time=x.time||(new Date()).getTime();if(u.callbacks.event){y=0;z=u.callbacks.event.length;for(y;y<z;y+=1){u.callbacks.event[y].func(x)}}x.has_fired=true};u._getUnfiredEvents=function(){var x=0;for(x=0;x<s.events.length;x+=1){if(!s.events[x].has_fired){u.unfired_events.push(s.events.splice(x,1)[0]);x-=1}}};u._fireEvents=function(){while(u.unfired_events.length>0){s.events.push(u.unfired_events.shift())}};u._resetEventsPush=function(){s.events=s.events||[];if(s.events.push.toString().indexOf("[native code]")!==-1){s.events.push=u._eventsPush;u._getUnfiredEvents();u._fireEvents()}};u._checkForChanges=function(){if(u.callbacks.change&&u.callbacks.change.length>0){if(!u._jsonIsEqual(u.currentUV,s)){u._trigger("change",s);u.currentUV=p.stringify(s,u._stripEvents)}}};u._setUVLocation=function(x){t=x;u._initUV()};u._initUV=function(){window[t]=window[t]||{events:[]};s=window[t];if(!s.events){s.events=[]}};u.push=function(x){if(!u._isArray(x)){return}if(x[0]==="on"){u._on(x[1],x[2])}else{if(x[0]==="trigger"&&x[1]){u._trigger(x[1])}}};u.init=function(y,x){if(x){t=x}u._initUV();if(!window.uv_listener||u._isArray(window.uv_listener)){u.early_callbacks=window.uv_listener||null;window.uv_listener=u;if(!y){u.start()}}else{if(x){window.uv_listener._setUVLocation(t)}}};u.start=function(){u.currentUV=p.stringify(s,u._stripEvents);v=setInterval(function(){u._initUV();u._resetEventsPush();u._checkForChanges()},w);u._processCallbacks()};b.html.UVListener=u}());(function(){function q(r){this.tagManager=r}q.prototype.sendLoadTimes=function(s){var u,t,r,w,v;if(!this.tagManager.isTellingLoadTimes){return}t="c="+s.qTagClientId+"&p="+s.profileName+"&l="+(s.tellLoadTimesProbability)+"&pv="+b.cookie.PageView.update()+"&d=";r=[];v=this.tagManager.loadTimes;for(u in v){if(v.hasOwnProperty(u)){w=this.tagManager.loadTimes[u];r.push('"'+u+'":'+(w.end-w.start));delete this.tagManager.loadTimes[u]}}t+=encodeURIComponent("{"+r.join(",")+"}");if(s.pingServerUrl){b.html.PostData("//"+s.pingServerUrl+"/tag2?"+t,null,"GET")}this.sendErrors(s)};q.prototype.sendErrors=function(r){if(!window.openTag_sendErrors){return}var u,t,v,s=[];for(u in this.tagManager.errors){if(this.tagManager.errors.hasOwnProperty(u)){t=this.tagManager.errors[u];s.push("{r: '"+t.reason+"',u:'"+t.url+"',l:'"+t.lineNumber+"'}")}}if(s.length>0){if(window.console&&window.console.log){window.console.log(s.join(","))}v="c="+r.qTagClientId+"&p="+r.profileName+"&pv="+b.cookie.PageView.update()+"&e="+("["+s.join(",")+"]");if(r.pingServerUrl){b.html.PostData("//"+r.pingServerUrl+"/tag_err?"+v,null,"GET")}}};q.prototype.handleDedupe=function(r,s){this.sendDedupePings(this.determineDedupeLoaders(r),s)};q.prototype.determineDedupeLoaders=function(w,v){var s,t,u,r;s=[];for(t in w){if(w.hasOwnProperty(t)){r=w[t];if((r.dedupe===this.tagManager.DEDUPE_URL_FILTER)&&(r.state===this.tagManager.NOT_LOADED)){s.push(r)}}}return s};q.prototype.sendDedupePings=function(t,u){var v,w,s,x,r;if(this.tagManager.isTellingLoadTimes){x="c="+u.qTagClientId+"&p="+u.profileName+"&l="+(u.tellLoadTimesProbability)+"&pv="+b.cookie.PageView.update()+"&dd=";r=[];for(v=0,w=t.length;v<w;v+=1){s=t[v];r.push(s.id)}x+=encodeURIComponent("["+r.join(",")+"]");if(u.pingServerUrl&&r.length>0){b.html.PostData("//"+u.pingServerUrl+"/tag2?"+x,null,"GET")}}};qubit.qtag.Ping=qubit.qtag.Ping||q}());b.cookie.SimpleSessionCounter={};b.cookie.SimpleSessionCounter._cookieName="_qst_s";b.cookie.SimpleSessionCounter._sessionCookie="_qsst_s";b.cookie.SimpleSessionCounter.update=function(t){var v,q,u,r=30;v=b.html.simplecookie.readCookie(b.cookie.SimpleSessionCounter._cookieName);q=b.html.simplecookie.readCookie(b.cookie.SimpleSessionCounter._sessionCookie);if(!v){v=1}else{v=parseInt(v,10);if(!q||(parseInt(q,10)<(new Date().getTime()-r*60*1000))){v+=1}}b.html.simplecookie.writeCookie(b.cookie.SimpleSessionCounter._cookieName,v,365,t);b.html.simplecookie.writeCookie(b.cookie.SimpleSessionCounter._sessionCookie,new Date().getTime().toString(),null,t);return v};(function(){function r(){}var q=b.html.simplecookie,s=qubit.qtag.Utils;r.setupSession=function(u){var z,w,v,x,A,t;z={};z.sessionCount=b.cookie.SimpleSessionCounter.update(u.qtag_domain);
A="qtag_"+u.profileName;v=q.readCookie(A);if(v){try{v=p.parse(v)}catch(y){v={sc:0,sessionCount:0,pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}}}}else{v={sc:0,sessionCount:0,pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}}}t=new Date().getTime();if(z.sessionCount!==parseInt(v.sc,10)){v.sessionStartTime=t;v.sc=z.sessionCount;v.sessionCount+=1;v.referrer.push({url:r.getReferrer(),landing:s.getUrl().substring(0,300),time:t});v.sessionLandingPage=s.getUrl().substring(0,300)}else{if(r.isReferrerDifferent()){if(!r.referrerIsSameAsPrevious(v.referrer,t,30*60*1000)){v.referrer.push({url:r.getReferrer(),landing:s.getUrl().substring(0,300),time:t});v.sessionLandingPage=s.getUrl().substring(0,300);v.sessionStartTime=t;v.sessionCount+=1}}}z.sessionCount=v.sessionCount;z.sessionStartTime=v.sessionStartTime;z.pageStartTime=t;v.pageViews+=1;z.pageViews=v.pageViews;z.sessionLandingPage=v.sessionLandingPage;z.referrer=v.referrer;if(z.referrer.length>5){z.referrer.splice(2,z.referrer.length-5)}x=p.stringify(v);w=0;while((x.length>u.maxCookieLength)&&(w<5)){if(v.referrer.length>=3){v.referrer.splice(2,1)}else{if(v.referrer.length===2){v.referrer=[v.referrer[0]]}else{if(v.referrer.length===1){v.referrer=[]}}}x=p.stringify(v);w+=1}z.referrer=v.referrer;q.writeCookie(A,x,-100,"");q.writeCookie(A,x,365,u.qtag_domain);z.setVariable=function(C,D,E){var B=(!!E)?E:0;v.__v[C]=[D,B];q.writeCookie(A,p.stringify(v),365,u.qtag_domain)};z.getCookie=q.readCookie;z.getVariable=function(E){var B,D,C;B=v.__v[E];if(B){D=B[1];if((D===0)||(D>new Date().getTime())){return B[0]}}return null};z.on=function(D,C,B){if(C.attachEvent){C.attachEvent("on"+D,B)}else{if(C.addEventListener){C.addEventListener(D,B,false)}}};z.getTagCookie=function(){return q.readCookie(A)};r.lastSession=z;return z};r.referrerIsSameAsPrevious=function(u,w,y){var v,t,x;if(u.length>0){v=r.getReferrer();t=s.getUrl().substring(0,300);x=u[u.length-1];return(x.url===v)&&(x.landing===t)&&((x.time+y)>w)}return false};r.isReferrerDifferent=function(){var w,t,v;v=r.getReferrer();w=v.indexOf("://");if(w===-1){return true}w+=3;try{if(v.substring(w).indexOf(r.getDomain())!==0){return true}return false}catch(u){return true}};r.getReferrer=function(){if(document.referrer){return document.referrer.substring(0,300)}return"direct"};r.getDomain=function(){return document.location.host};qubit.qtag.Session=qubit.qtag.Session||r}());(function(){var q={},s=qubit.qtag.Utils,r={};q.registerTag=function(t){var u=t.getConfig().profileName;if(r[u]){}r[u]=t};q.getTag=function(t){return r[t]};q.getAllTags=function(){return r};q.getVariableValue=function(v,t,w){try{var B=r[v];var u=B.getConfig();var z=u.scriptLoaders[t];var A=u.pageVars[w];if(s.variableExists(A.pageValue)){return A.pageValue}var x=String(z.pageVars[w].defaultValue);return x}catch(y){}};qubit.Tags=qubit.Tags||q})();var f=[],h={},l={},n=false,g="",c="Opentag",a="",m=0,j=3000,k=null,d=false,i="",o=null;d=true;var g="27295";var a="31253";var f=[{filterType:"1",name:"Search Engine referral AND Article",patternType:"100",pattern:function(q){return((document.referrer.indexOf&&document.referrer.indexOf(".google.")>=0))&&((document.location.href.indexOf&&document.location.href.indexOf("/cms/s/")>=0))},priority:4,id:37073591,scriptLoaderKeys:["57757"]},{filterType:"2",name:"Free articles",patternType:"2",pattern:"/cms/s/2/",priority:2,id:37073599,scriptLoaderKeys:["57757"]},{filterType:"2",name:"Exclude logged in users",patternType:"100",pattern:function(q){return(((q.getCookie("FT_U")||""))||((q.getCookie("FT_Remember")||"")))},priority:3,id:37073607,scriptLoaderKeys:["57757"]},{filterType:"2",name:"Corporate IP Access (_27 equals anything other than PVT)",patternType:"100",pattern:function(q){return((new RegExp("_27(?![^_]*PVT)").test((q.getCookie("AYSC")||""))))},priority:1,id:37073614,scriptLoaderKeys:["57757"]},{filterType:"2",name:"MobileRedirectTesting",patternType:"100",pattern:function(q){return(((q.getCookie("MobileRedirectTesting")||"")))},priority:1,id:37073638,scriptLoaderKeys:["454063"]},{filterType:"1",name:"Default filter: Match all",patternType:"1",pattern:"",priority:2,id:37073647,scriptLoaderKeys:["454063"]},{filterType:"1",name:"Default filter: Match all",patternType:"1",pattern:"",priority:8,id:37073707,scriptLoaderKeys:["1158291"]},{filterType:"2",name:"Exclude internal stories",patternType:"2",pattern:"story.internal",priority:5,id:37073721,scriptLoaderKeys:["1158291"]},{filterType:"2",name:"Exclude previews",patternType:"2",pattern:"preview=true",priority:4,id:37073734,scriptLoaderKeys:["1158291"]},{filterType:"2",name:"Exclude Preditor",patternType:"2",pattern:"preditor.ft.com",priority:7,id:37073744,scriptLoaderKeys:["1158291"]},{filterType:"2",name:"Exclude from video.ft.com",patternType:"2",pattern:"video.ft.com",priority:3,id:37073758,scriptLoaderKeys:["1158291"]},{filterType:"2",name:"Exclude articles with pay wall",patternType:"2",pattern:"Authorised=false.html",priority:6,id:37073767,scriptLoaderKeys:["1158291"]},{filterType:"2",name:"Disable on OSB TV Screens",patternType:"2",pattern:"disablecookieconsent=true",priority:2,id:37073776,scriptLoaderKeys:["1158291"]},{filterType:"2",name:"Exclude from www.ft.com/fastft",patternType:"2",pattern:"www.ft.com/fastft",priority:1,id:37073783,scriptLoaderKeys:["1158291"]},{filterType:"1",name:"Default filter: Match all",patternType:"1",pattern:"",priority:3,id:37073864,scriptLoaderKeys:["1686775"]},{filterType:"2",name:"exclude_preditor",patternType:"2",pattern:"preditor",priority:2,id:37073872,scriptLoaderKeys:["1686775"]},{filterType:"2",name:"exclude with session cookie",patternType:"100",pattern:function(q){return(((q.getCookie("env-switch")||"")))},priority:1,id:37073874,scriptLoaderKeys:["1686775"]},{filterType:"2",name:"Exclude from previews",patternType:"2",pattern:"preview=true",priority:2,id:37073885,scriptLoaderKeys:["1839843"]},{filterType:"2",name:"Exclude form preditor",patternType:"2",pattern:"preditor",priority:3,id:37073897,scriptLoaderKeys:["1839843"]},{filterType:"2",name:"Exclude form internal",patternType:"2",pattern:"story.internal",priority:1,id:37073903,scriptLoaderKeys:["1839843"]},{filterType:"1",name:"Default filter: Match all",patternType:"1",pattern:"",priority:4,id:37073906,scriptLoaderKeys:["1839843"]},{filterType:"1",name:"Include on session cookie",patternType:"100",pattern:function(q){return(((q.getCookie("env-switch")||"")==="int"))},priority:1,id:37073912,scriptLoaderKeys:["2383185"]},{filterType:"1",name:"Include on session variable",patternType:"100",pattern:function(q){return(((q.getCookie("env-switch")||"")==="test"))},priority:1,id:37073916,scriptLoaderKeys:["2383191"]},{filterType:"1",name:"FT_BETAFEATURES cookie present",patternType:"100",pattern:function(q){return(((q.getCookie("FT_BETAFEATURES")||"")))},priority:2,id:37073957,scriptLoaderKeys:["3475686"]},{filterType:"1",name:"FT_BETAFEATURES",patternType:"2",pattern:"FT_BETAFEATURES",priority:1,id:37073959,scriptLoaderKeys:["3475686"]},{filterType:"1",name:"Default filter: Match all",patternType:"1",pattern:"",priority:1,id:37073964,scriptLoaderKeys:["6293403"]},{filterType:"1",name:"Default filter: Match all",patternType:"1",pattern:"",priority:1,id:37073971,scriptLoaderKeys:["7239480"]},{filterType:"1",name:"Default filter: Match all",patternType:"1",pattern:"",priority:1,id:37073979,scriptLoaderKeys:["11119936"]},{filterType:"1",name:"Include if '[?|&]clearBetaFeatureCookie' is in URL",patternType:"3",pattern:"[\\?\\&]clearBetaFeatureCookie",priority:1,id:37073991,scriptLoaderKeys:["13088382"]},{filterType:"1",name:"Include if '[?|&]setBetaFeatureCookie' is in URL",patternType:"3",pattern:"[\\?\\&]setBetaFeatureCookie",priority:2,id:37073994,scriptLoaderKeys:["13088382"]},{filterType:"1",name:"Default filter: Match all",patternType:"1",pattern:"",priority:1,id:37073999,scriptLoaderKeys:["13988647"]},{filterType:"1",name:"Has Beta Features cookie and Ferret Feature cookie and is on 'A high stakes brand merger...' article",patternType:"100",pattern:function(q){return(((q.getCookie("FT_BETAFEATURES")||""))&&((q.getCookie("FTBF_FERRET")||"")))&&((document.location.href.indexOf&&document.location.href.indexOf("/cms/s/0/f52ab3bc-842e-11e3-b72e-00144feab7de.html")>=0)||(document.location.href.indexOf&&document.location.href.indexOf("/cms/s/0/c6f6714a-8747-11e3-9c5c-00144feab7de.html")>=0))
},priority:1,id:37074003,scriptLoaderKeys:["14148937"]},{filterType:"2",name:"Exclude if they have enabled the beta one",patternType:"100",pattern:function(q){return(((q.getCookie("FTBF_AUTHOR_ALERTS_FREQ")||"")))},priority:1,id:37074036,scriptLoaderKeys:["18408731"]},{filterType:"1",name:"ft.com",patternType:"2",pattern:"",priority:2,id:37074043,scriptLoaderKeys:["18408731"]},{filterType:"1",name:"Default filter: Match all",patternType:"1",pattern:"",priority:1,id:37074055,scriptLoaderKeys:["20256431"]},{filterType:"1",name:"Video hub only",patternType:"2",pattern:"video.ft.com",priority:1,id:37074060,scriptLoaderKeys:["20995880"]},{filterType:"1",name:"Enable on all URLs",patternType:"1",pattern:"",priority:3,id:37074086,scriptLoaderKeys:["22878890"]},{filterType:"2",name:"Exclude from Methode preview",patternType:"2",pattern:"story.internal.ft.com",priority:1,id:37074087,scriptLoaderKeys:["22878890"]},{filterType:"2",name:"Exclude from preditor",patternType:"2",pattern:"preditor.internal.ft.com",priority:2,id:37074089,scriptLoaderKeys:["22878890"]},{filterType:"1",name:"FTBF_AUTHOR_ALERTS_FREQ",patternType:"100",pattern:function(q){return(((q.getCookie("FTBF_AUTHOR_ALERTS_FREQ")||"")==="enabled"))},priority:1,id:37074090,scriptLoaderKeys:["26202326"]},{filterType:"1",name:"Alphaville feature flag",patternType:"2",pattern:"enableSentry",priority:1,id:37074097,scriptLoaderKeys:["30255317"]},{filterType:"1",name:"URL Filter",patternType:"2",pattern:"ftalphaville.ft.com/marketslive",priority:1,id:37074099,scriptLoaderKeys:["30340584"]}];var h={};var l={57757:{id:"57757",name:"I320: Google Consumer Survey (aka 402)",pre:"",url:"",post:"",html:"<script type=\x22text/javascript\x22>\x0A  \x0A  FT.env.dfp_targeting = \x22gcs=true;pt=art\x22;\x0A  \x0A  $(\x27#storyContent\x27).addClass(\x27p402_premium\x27);\x0A\x0A  function GcsSurveyShown () {\x0A    FT.customEvents.trigger(\x27surveyShown.GCS\x27);\x0A  }\x0A  function GcsAccessGranted () {\x0A    FT.customEvents.trigger(\x27accessGranted.GCS\x27);\x0A  }\x0A  \x0A  var TriggerPrompt = function(articleUrl, contentId) {\x0A    var ARTICLE_URL = articleUrl;\x0A    var CONTENT_ID = contentId || \x27\x27;\x0A    var el = document.createElement(\x27script\x27);\x0A    var url = \x27http://survey.g.doubleclick.net/survey?site=40467365\x27 +\x0A              \x27&url=\x27 + encodeURIComponent(ARTICLE_URL) + (CONTENT_ID ? \x27&cid=\x27 + encodeURIComponent(CONTENT_ID) : \x27\x27) +\x0A              \x27&random=\x27 + (new Date).getTime() +\x0A              \x27&after=1\x27 +\x0A              \x27&divId=storyContent\x27;\x0A    el.setAttribute(\x27src\x27, url);\x0A    var head = document.getElementsByTagName(\x27head\x27)[0] ||\x0A        document.getElementsByTagName(\x27body\x27)[0];\x0A    head.appendChild(el);\x0A  };\x0A  TriggerPrompt(window.location.href, (new Date()).getTime());\x0A  if (FT && FT.analytics && FT.analytics.siteIntelligence) {\x0A    FT.analytics.siteIntelligence.sendAdditionalTracer(\x22/eventonpage\x22, \x22type=gcs&data=requested\x22);\x0A  }\x0A\x0A<\/script>",locationId:2,positionId:2,locationDetail:"storyContent",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},454063:{id:"454063",name:"DE4384 (workaround)",pre:"",url:"",post:"",html:"<script type=\x22text/javascript\x22>\x0AFT.wrapper = FT.wrapper || {};\x0AFT.wrapper.initialisers = FT.wrapper.initialisers || [];\x0AFT.wrapper.initialisers.push(function() {\x0A	$(\x22#deviceSwitchingLink\x22).css(\x22display\x22,\x22none\x22);\x0A});\x0A<\/script>",locationId:2,positionId:2,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},1158291:{id:"1158291",name:"US21222 CookieConsent File Reference",pre:"",url:"http://s2.media.ft.com/m/resources/cookieconsent/js/cookieConsent-min.js",post:"// Initialise the overlay\x0AcookieConsent.init();",html:"",locationId:2,positionId:1,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},1686775:{id:"1686775",name:"US22216 Personalisation",scriptTimeout:5000,pre:"",url:"",post:"",html:"<script>\x0A// Browsers are caching the personalisation script and it is being executed before jQuery is ready\x0A// This is a problem because it has a dependency on jQuery. This snippet will poll for jQuery\x0A// and inject the script when it is ready\x0A(function () {\x0A  var checkCounter = 0, retries = 10, retryInterval = 200;\x0A  function addScript (script) {\x0A    if (typeof $ !== \x27undefined\x27) {\x0A      $(function () {\x0A        $(document).one(\x27scroll\x27, function () {\x0A          var url = \x27http://personalisation.ft.com/assets/js/personalisation.min.js\x27;\x0A          var script = document.createElement(\x27script\x27);\x0A          script.type = \x27text/javascript\x27;\x0A          script.async = true;\x0A          script.setAttribute(\x27id\x27, \x27p13n_script\x27);\x0A          script.setAttribute(\x27data-features\x27, \x27a\x27);\x0A          script.setAttribute(\x27data-base\x27, \x27http://personalisation.ft.com/\x27);\x0A          script.src = url;\x0A          var s = document.getElementsByTagName(\x27script\x27)[0];\x0A          s.parentNode.insertBefore(script, s);\x0A        });\x0A      });\x0A    } else {\x0A      checkCounter++;\x0A      if (checkCounter < retries) {\x0A        setTimeout(function (script) {\x0A          addScript(script);\x0A        }, retryInterval);\x0A      }\x0A    }\x0A  }\x0A  addScript();\x0A}());\x0A<\/script>",locationId:2,positionId:2,locationDetail:"",async:false,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},1839843:{id:"1839843",name:"US19952 Chartbeat",scriptTimeout:5000,pre:"",url:"",post:"",html:"<script>\x0A    /*global FT,$,Track*/\x0A    try {\x0A        if (FT && (\x0A            (FT.isPage && (FT.isPage.Site !== 1 || FT.isPage.Section !== 0 || FT.isPage.Front !== 0)) ||\x0A            (FT.env && (\x0A                FT.env.dfp_site === \x22ftcom.5887.bus-school-rankings\x22 ||\x0A                FT.env.dfp_site === \x22ftcom.5887.markets-data\x22 ||\x0A                FT.env.dfp_site === \x22ftcom.5887.video\x22  ||\x0A                FT.env.dfp_site === \x22ftcom.5887.topics\x22 ||\x0A                FT.env.dfp_site === \x22ftcom.5887.podcast\x22 ||\x0A                FT.env.dfp_site === \x22ftcom.5887.clippings\x22 ||\x0A                FT.env.dfp_site === \x22ftcom.5887.cuttings\x22 ||\x0A                FT.env.dfp_site === \x22ftcom.5887.blogs\x22 ||\x0A                FT.env.dfp_site === \x22ftcom.5887.alphaville\x22 ||\x0A                FT.env.dfp_site === \x22ftcom.5887.business-education\x22 ||\x0A                FT.env.dfp_site === \x22ftcom.5887.technology\x22 ||\x0A                FT.env.dfp_site === \x22ftcom.5887.comment\x22\x0A            ))  ||\x0A            window.siteMapTerm === \x22Products.Lexicon\x22\x0A        ))\x0A        {\x0A          \x0A          // We are setting a flag for the Sticky Ads trial.\x0A          // This flag should be removed after the sticky ads trial has completed.\x0A          if (typeof mmcore !== \x27undefined\x27 && typeof mmcore.GenInfo !== \x27undefined\x27 && typeof mmcore.GenInfo[\x27VC25_Sticky_ads\x27] !== \x27undefined\x27){\x0A              FT.stickyAd = (mmcore.GenInfo[\x27VC25_Sticky_ads\x27].element9998 === \x27stickyads\x27) ? \x271\x27 : \x270\x27;\x0A          }\x0A\x0A            /** CONFIGURATION START **/\x0A            var _sf_async_config = {\x0A                uid: 14181,\x0A                domain: \x22ft.com\x22,\x0A                useCanonical: true\x0A            };\x0A\x0A            _sf_async_config.sections = (function () {\x0A                \x22use strict\x22;\x0A                var siteMapTermSectionName = typeof window.siteMapTerm !== \x22undefined\x22 ? window.siteMapTerm : \x22\x22,\x0A                        typeOfPage;\x0A                siteMapTermSectionName = siteMapTermSectionName.replace(/([^\x5C.]*)\x5C./, \x22\x22);\x0A\x0A                if (FT.isPage.Context === 1 && FT.isPage.Story === 1) {\x0A                    typeOfPage = \x27articles\x27;\x0A                } else if (FT.isPage.Site === 1) {\x0A                    if (FT.isPage.Front === 1) {\x0A                        typeOfPage = \x27frontpages\x27;\x0A                    } else if (FT.isPage.Section === 1) {\x0A                        typeOfPage = \x27sections\x27;\x0A                    }\x0A                }\x0A               if (FT.env.dfp_site===\x22ftcom.5887.markets-data\x22 || FT.env.dfp_site===\x22ftcom.5887.bus-school-rankings\x22  || siteMapTerm === \x22Products.Lexicon\x22 || FT.env.dfp_site === \x22ftcom.5887.video\x22  || FT.env.dfp_site === \x22ftcom.5887.topics\x22 || FT.env.dfp_site === \x22ftcom.5887.podcast\x22 || FT.env.dfp_site === \x22ftcom.5887.clippings\x22 ||\x0A               FT.env.dfp_site === \x22ftcom.5887.cuttings\x22 || FT.env.dfp_site === \x22ftcom.5887.blogs\x22 || FT.env.dfp_site === \x22ftcom.5887.alphaville\x22 || FT.env.dfp_site === \x22ftcom.5887.business-education\x22 || FT.env.dfp_site === \x22ftcom.5887.technology\x22 || FT.env.dfp_site === \x22ftcom.5887.comment\x22) {typeOfPage=\x22sections\x22;}\x0A                return siteMapTermSectionName + \x27, \x27 + typeOfPage;\x0A            }());\x0A            //advertising site and zone data\x0A            _sf_async_config.zone= FT.ads.metadata.page().dfpSite + \x22/\x22 + FT.ads.metadata.page().dfpZone;\x0A            /** CONFIGURATION END **/\x0A\x0A            (function () {\x0A                \x22use strict\x22;\x0A                function loadChartbeat() {\x0A                    window._sf_startpt = (FT.analytics.timerStore.getTimers().hasOwnProperty(\x27perceivedLoadTime\x27) ? FT.analytics.timerStore.getTimers().perceivedLoadTime.start : (new Date()).getTime() - 1000);\x0A                    window._sf_endpt = (new Date()).getTime();\x0A                    if (FT.isPage.Context === 1 && FT.isPage.Story === 1) {\x0A                        window._sf_async_config.authors = ($(\x22.byline span\x22).text().replace(/By +/, \x22\x22));\x0A                    }\x0A                    else if ((\x0A                      FT.env.dfp_site === \x22ftcom.5887.blogs\x22 ||\x0A                      FT.env.dfp_site === \x22ftcom.5887.alphaville\x22 ||\x0A                      FT.env.dfp_site === \x22ftcom.5887.business-education\x22\x0A                      ) &&  $(\x27.entry-meta strong a\x27)[0]) {\x0A                         window._sf_async_config.authors = $(\x27.entry-meta strong a\x27)[0].text.replace(/(\x5Ct|\x5Cn)/g,\x27\x27);\x0A                    }\x0A\x0A                    window._cbq = window._cbq || [];\x0A\x0A                   // user edition\x0A                   var userEdition = FT.cookie.getParam(\x27AYSC\x27, 28),\x0A                         userTypes = {\x0A                            1: \x27anon\x27,\x0A                            2: \x27lgdin\x27,\x0A                            3: \x27paid\x27,\x0A                            4: \x27lgdin_inactive\x27,\x0A                            5: \x27paid_inactive\x27\x0A                         },\x0A                         ftpCookie = FT.cookie.get(\x22FT_P\x22),\x0A                         cohortCode = 1,\x0A                         prods,\x0A                         e;\x0A\x0A                   if (userEdition && userEdition !== \x27PVT\x27) {\x0A                      window._cbq.push([\x22_edt\x22, userEdition]);\x0A                   } else {\x0A                      window._cbq.push([\x22_edt\x22, \x22default\x22]);\x0A                   }\x0A\x0A                   // cohort, user type\x0A                   if (ftpCookie) {\x0A                      prods = ftpCookie.match(/prod=([^_]*)/) ? RegExp.$1 : null;\x0A                      cohortCode = Track.Util.findSubType(prods);\x0A                   }\x0A                   window._cbq.push([\x22_acct\x22, userTypes[cohortCode]]);\x0A\x0A                   // demographic data\x0A                   var demographicData = \x22\x22,\x0A                         userObj = FT.ads.metadata.user(),\x0A                         demographicCodes = {\x0A                            \x2702\x27 : userObj.gender, // Gender\x0A                            \x2705\x27 : userObj.industry, // Industry\x0A                            \x2706\x27 : userObj.job_responsibility, // Responsibility\x0A                            \x2707\x27 : userObj.job_position, // Position\x0A                            \x2719\x27 : userObj.company_size, // Company Size\x0A                            \x2740\x27 : userObj.DB_company_size, // DB Company Size\x0A                            \x2741\x27 : userObj.DB_industry, // DB Industry\x0A                            \x2742\x27 : userObj.DB_company_turnover, // DB Company Takeover\x0A                            \x2746\x27 : userObj.cameo_investor_code, // Cameo Investor\x0A                            \x2751\x27 : userObj.cameo_property_code, // Cameo Property\x0A                            \x27slv\x27 : ((userObj.subscription_level) ? userObj.subscription_level : \x27anon\x27),\x0A                            \x2799\x27 : FT.stickyAd // temporary flag set for sticky ads trial\x0A                            }; // subscriber level\x0A\x0A                   function blankIfInvalid( value ) {\x0A                      return (!value || value.match(/(NULL)|(null)/)) ? \x22\x22 : value;\x0A                   }\x0A\x0A                   // add demographics data\x0A                   for (var key in demographicCodes) {\x0A                      if (demographicData.length !== 0) demographicData += \x22,\x22;\x0A                      demographicData = demographicData + key + \x22=\x22 + blankIfInvalid(demographicCodes[key]);\x0A                   }\x0A\x0A                   window._cbq.push([\x22_demo\x22, demographicData]);\x0A\x0A                    e = document.createElement(\x22script\x22);\x0A                    e.setAttribute(\x22language\x22, \x22javascript\x22);\x0A                    e.setAttribute(\x22type\x22, \x22text/javascript\x22);\x0A                    e.setAttribute(\x22src\x22,  ((\x22https:\x22 == document.location.protocol) ? \x22https://s3.amazonaws.com/\x22 : \x22http://\x22) + \x22static.chartbeat.com/js/chartbeat_pub.js\x22);\x0A                    document.body.appendChild(e);\x0A                }\x0A\x0A                $(document).ready(function () {\x0A                    loadChartbeat();\x0A                });\x0A            }());\x0A        }\x0A    } catch (e) {\x0A        //if (window.console) {\x0A        //    console.log(e);\x0A        //}\x0A    }\x0A<\/script>",locationId:2,positionId:2,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},2383185:{id:"2383185",name:"US23874 Personalisation switch 1",pre:"",url:"",post:"",html:"<script id=\x22p13n_script\x22 data-base=\x22http://p13n-int.herokuapp.com/\x22 data-features=\x22a\x22 src=\x22http://p13n-int.herokuapp.com/assets/js/personalisation.min.js\x22 async><\/script>",locationId:2,positionId:1,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},2383191:{id:"2383191",name:"US23874 Personalisation Switch 2",pre:"",url:"",post:"",html:"<script id=\x22p13n_script\x22 data-base=\x22http://p13n-test.herokuapp.com/\x22 data-features=\x22a\x22 src=\x22http://p13n-test.herokuapp.com/assets/js/personalisation.min.js\x22 async><\/script>",locationId:2,positionId:1,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},3475686:{id:"3475686",name:"Include Internal Beta Features",pre:"",url:"http://d3c3cq33003psk.cloudfront.net/opentag-27295-36314.js",post:"",html:"",locationId:1,positionId:1,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},6293403:{id:"6293403",name:"advertising",scriptTimeout:5000,pre:"",url:"",post:"",html:"<script>\x0A    FT.env.advertising = \x271.0.49\x27; //set advertising version via opentag var\x0A\x0A    //function to enable GPT for whitelisted dfp-sites or when a testing cookie is set.\x0A    FT.env.gptSwitcher = function(){\x0A        var whitelist =  \x27:\x27 + [\x27ftcom.5887.home\x27, \x27ftcom.5887.markets\x27, \x27ftcom.5887.in-depth\x27, \x27ftcom.5887.comment\x27, \x27ftcom.5887.global-economy\x27, \x27ftcom.5887.world\x27, \x27ftcom.5887.companies\x27, \x27ftcom.5887.personal-finance\x27, \x27ftcom.5887.arts-and-leisure\x27, \x27ftcom.5887.lex\x27, \x27ftcom.5887.management\x27, \x27ftcom.5887.business-education\x27, \x27ftcom.5887.ftfm\x27, \x27ftcom.5887.special-reports\x27,\x27ftcom.5887.search\x27, \x27ftcom.5887.blogs\x27, \x27ftcom.5887.markets-data\x27, \x27ftcom.5887.etfs\x27, \x27ftcom.5887.podcast\x27, \x27ftcom.5887.video\x27, \x27ftcom.5887.lexicon\x27, \x27ftcom.5887.clippings\x27, \x27ftcom.5887.technology\x27, \x27ftcom.5887.bus-school-rankings\x27, \x27ftcom.5887.bus-school-rankings\x27, \x27ftcom.5887.alphaville\x27 ].join(\x27:\x27) + \x27:\x27,\x0A                site = FT.env.dfp_site || \x27\x27,\x0A                zone = FT.env.dfp_zone || \x27\x27,\x0A                assetType = FT.env.asset || \x27\x27,\x0A                mode = /;\x5Cs?ftadsmode=gpt;/.test(document.cookie);\x0A        if(mode || (~whitelist.indexOf(\x27:\x27 + site + \x27:\x27))) {FT.env.advertising = \x27gpt-\x27 + FT.env.advertising; }\x0A    };\x0A    FT.env.gptSwitcher();\x0A\x0A    //cancel in-situ refresh configuration\x0A    FT.env.refreshCancelFilter = function(){\x0A        if (FT._ads.utils.isString(FT._ads.utils.cookie(\x22AYSC\x22))){\x0A            var q = FT._ads.utils.cookie(\x22AYSC\x22);\x0A            var re = /_15([^_]*)/;\x0A            var countryCode = q.match(re);\x0A            if (countryCode !==null && countryCode.length >0){\x0A                countryCode = countryCode[1];\x0A                if ((countryCode === \x22gb\x22 || countryCode === \x22us\x22) && (siteMapTerm !== \x22Sections.Front page\x22)) {\x0A                    return true;\x0A                }\x0A                else {return false;}\x0A            }\x0A        }\x0A    };\x0A    FT.env.suppressKrux = false;\x0A    FT.env.kruxMaxSegs = 70;\x0A    \x0A    window.googletag = window.googletag || {};\x0A    window.googletag.cmd = window.googletag.cmd || [];\x0A    googletag.cmd.push(function(){\x0A      if (typeof mmcore !== \x27undefined\x27 && typeof mmcore.GenInfo !== \x27undefined\x27 && typeof mmcore.GenInfo[\x27VC25_Sticky_ads\x27] !== \x27undefined\x27){\x0A        var stickyBanner = (mmcore.GenInfo[\x27VC25_Sticky_ads\x27].element9998 === \x27stickyads\x27) ? \x27y\x27 : \x27n\x27;\x0A        googletag.pubads().setTargeting(\x27stky\x27, stickyBanner);\x0A      }\x0A      var iai = (document.location.href.indexOf(\x27Authorised=false.html?_i_location=\x27) !== -1) ? \x27y\x27 : \x27n\x27;\x0A      googletag.pubads().setTargeting(\x27br\x27,iai);\x0A    });\x0A<\/script>",locationId:1,positionId:1,locationDetail:"",async:false,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},7239480:{id:"7239480",name:"US28006 Social Login",pre:"",url:"http://reg.ft-static.com/social/social.js",post:"function socialLoginOnload() {\x0Aif (FT.social && document.URL.indexOf(\x22Authorised=false\x22) === -1) {\x0Avar location = FT.social.getLocationParameter() || decodeURIComponent(document.URL);\x0AFT.social.loadLoginWidget({\x0AappendInElement: \x27#ftLogin-box form\x27,\x0AsuccessUrl: location,\x0AunsuccessfulUrl: \x27https://registration.ft.com/signup/register?segid=70767&location=\x27 + location,\x0Atarget: \x27HOMEPAGE\x27,\x0AregistrationAssetsUrl: \x27http://reg.ft-static.com\x27\x0A});\x0A}\x0A}\x0A\x0Aif (document.addEventListener) {\x0Adocument.addEventListener(\x22DOMContentLoaded\x22, socialLoginOnload, false);\x0A} else {\x0Awindow.attachEvent(\x27onload\x27, socialLoginOnload);\x0A}\x0A\x0AsocialLoginOnload();",html:"",locationId:1,positionId:1,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},11119936:{id:"11119936",name:"US34984: Essence DFA tags",scriptTimeout:5000,pre:"",url:"",post:"",html:"<script>\x0A/*global Track*/\x0A(function (Track) {\x0A\x0A    var params = {\x0A        src :   4235225, // Same for all campaigns\x0A        u1 :    Track.Util.getValueFromCookie(/_EID=([0-9]+):/), // [Erights ID]\x0A        u2 :    \x27\x27, // [Package Type]\x0A        u5 :    Track.Util.findSubType(Track.Util.getValueFromCookie(/FT_P=[A-Za-z0-9=&|]*prod=([A-Za-z0-9=|]*);?/)), // [Subscription Type]\x0A        u7 :    Track.Util.getValueFromCookie(/AYSC=[^;]*_14([a-zA-Z0-9%]+)/), // [Country]\x0A        u8 :    \x27\x27, // [Currency]\x0A        u10 :   Track.Util.getValueFromCookie(/SIVISITOR=([^;]+)/), // [SIVISITOR]\x0A        cost :  \x27\x27, // [Revenue]\x0A        ord :   1,\x0A        num :   Math.random() * 10000000000000\x0A    };\x0A\x0A    function addTag(url) {\x0A        // Taken from http://www.lognormal.com/blog/2012/12/12/the-script-loader-pattern/ to avoid blocking onload\x0A        var where, iframe = document.createElement(\x27iframe\x27);\x0A        iframe.src = \x27javascript:false\x27;\x0A        iframe.title = \x22\x22;\x0A        iframe.role = \x22presentation\x22;  // a11y\x0A        (iframe.frameElement || iframe).style.cssText = \x22width: 0; height: 0; border: 0; display:none\x22;\x0A        where = document.getElementsByTagName(\x27script\x27);\x0A        where = where[where.length - 1];\x0A        where.parentNode.insertBefore(iframe, where);\x0A\x0A        iframe.src = url;\x0A    }\x0A\x0A    /*\x0A     * Activity ID: 1390878\x0A     * Activity Name: FT - Home\x0A     * Activity Group Name: home\x0A     */\x0A    addTag([\x0A        \x27http://4235225.fls.doubleclick.net/activityi;src=\x27, params.src, \x27;\x27,\x0A        \x27type=homeo886;\x27,\x0A        \x27cat=ft-ho780;\x27,\x0A        \x27u7=\x27, params.u7, \x27;\x27,\x0A        \x27u5=\x27, params.u5, \x27;\x27,\x0A        \x27u1=\x27, params.u1, \x27;\x27,\x0A        \x27u10=\x27, params.u10, \x27;\x27,\x0A        \x27ord=1;\x27,\x0A        \x27num=\x27, params.num,\x0A        \x27?\x27\x0A    ].join(\x27\x27));\x0A\x0A    /*\x0A     * Activity ID: 1390902\x0A     * Activity Name: FT - Login\x0A     * Activity Group Name: home\x0A     */\x0A    // Only send when registered user logged in.\x0A    if (params.u5 === 2) {\x0A        addTag([\x0A            \x27http://4235225.fls.doubleclick.net/activityi;src=\x27, params.src, \x27;\x27,\x0A            \x27type=login104;\x27,\x0A            \x27cat=ft-lo079;\x27,\x0A            \x27u7=\x27, params.u7, \x27;\x27,\x0A            \x27u1=\x27, params.u1, \x27;\x27,\x0A            \x27u10=\x27, params.u10, \x27;\x27,\x0A            \x27ord=1;\x27,\x0A            \x27num=\x27, params.num,\x0A            \x27?\x27\x0A        ].join(\x27\x27));\x0A    }\x0A    // Only send when subscribed user logged in.\x0A    if (params.u5 === 3) {\x0A        addTag([\x0A            \x27http://4235225.fls.doubleclick.net/activityi;src=\x27, params.src, \x27;\x27,\x0A            \x27type=login104;\x27,\x0A            \x27cat=login412;\x27,\x0A            \x27u7=\x27, params.u7, \x27;\x27,\x0A            \x27u1=\x27, params.u1, \x27;\x27,\x0A            \x27u10=\x27, params.u10, \x27;\x27,\x0A            \x27ord=1;\x27,\x0A            \x27num=\x27, params.num,\x0A            \x27?\x27\x0A        ].join(\x27\x27));\x0A    }\x0A\x0A}(Track));\x0A<\/script>",locationId:2,positionId:2,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},13088382:{id:"13088382",name:"Beta Features URL Toggle",scriptTimeout:5000,pre:"",url:"",post:"",html:"<script src=\x22http://www.ft-static.com/sp/prod/betaFeaturesUrlToggle/short/betaFeaturesUrlToggle.v3.1.1.js\x22><\/script>\x0A",locationId:2,positionId:2,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},13988647:{id:"13988647",name:"Guest Pass",pre:"",url:"",post:"",html:"<script> \x0A// This snippet will poll for jQuery and inject the script when it is ready \x0A(function () { \x0Avar checkCounter = 0, retries = 10, retryInterval = 200; \x0Afunction addScript (script) { \x0Aif (typeof $ !== \x27undefined\x27) { \x0Avar url = \x27http://reg.ft-static.com/guestpass/guestpass.js\x27; \x0Avar script = document.createElement(\x27script\x27); \x0Ascript.type = \x27text/javascript\x27; \x0Ascript.async = true; \x0Ascript.setAttribute(\x27id\x27, \x27guestpass_script\x27); \x0Ascript.setAttribute(\x27static-base\x27, \x27http://reg.ft-static.com/guestpass\x27); \x0Ascript.src = url; \x0Avar s = document.getElementsByTagName(\x27script\x27)[0]; \x0As.parentNode.insertBefore(script, s); \x0A\x0Avar cssUrl = \x27http://reg.ft-static.com/guestpass/assets/perm/css/guestpass.css\x27;\x0Avar link = document.createElement(\x27link\x27); \x0Alink.rel = \x27stylesheet\x27; \x0Alink.href = cssUrl; \x0Avar l = document.getElementsByTagName(\x27link\x27)[0]; \x0Al.parentNode.insertBefore(link, l); \x0A} else { \x0AcheckCounter++; \x0Aif (checkCounter < retries) { \x0AsetTimeout(function (script) { \x0AaddScript(script); \x0A}, retryInterval); \x0A} \x0A} \x0A} \x0A\x0Avar articlePattern = RegExp(\x27^http:\x5C/\x5C/.*\x5C.ft\x5C.com(/intl)?/cms/s/[0-3]/([0-9a-f\x5C-]+).*$\x27, \x27\x27); \x0Aif (articlePattern.test(document.URL)) { \x0AaddScript();\x0A}  \x0A}()); \x0A<\/script> ",locationId:2,positionId:2,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},14148937:{id:"14148937",name:"Team Snappy - Ferret Beta Test",scriptTimeout:5000,pre:"",url:"http://ft-snappy-02-debate.herokuapp.com/js/presentation.js",post:"",html:"",locationId:1,positionId:1,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},18408731:{id:"18408731",name:"FT_FOLLOW_AUTHOR",scriptTimeout:5000,pre:"",url:"http://www.ft-static.com/sp/prod/author_alerts/long/0.2.13/jsinclude.min.js",post:"",html:"",locationId:1,positionId:1,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},20256431:{id:"20256431",name:"Advertising Mill Ward Brown",scriptTimeout:5000,pre:"",url:"http://amch.questionmarket.com/adsc/d1146465/2/1154160/randm.js",post:"",html:"",locationId:1,positionId:1,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},20995880:{id:"20995880",name:"GPT Video HTML5 Player proxy",scriptTimeout:5000,pre:"",url:"http://s0.2mdn.net/instream/html5/gpt_proxy.js",post:"",html:"",locationId:1,positionId:1,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},22878890:{id:"22878890",name:"Livefyre commenting",scriptTimeout:5000,pre:"",url:"",post:"",html:"<script>\x0A    FT.$(document).ready(function () {\x0A        \x22use strict\x22;\x0A\x0A        var isOnFtDomain = function () {\x0A            return window.location.hostname.indexOf(\x27www.ft.com\x27, window.location.hostname.length - \x27www.ft.com\x27.length) !== -1;\x0A        };\x0A        \x0A        if (FT && FT.isPage && FT.isPage.Story === 1 && FT.$(\x27#ft-article-comments\x27).length && isOnFtDomain()) {\x0A            FT.$.ajax({\x0A                url: \x27http://www.ft-static.com/sp/prod/comments/3.2.0/long/ftcomIntegration.min.js\x27,\x0A                dataType: \x27script\x27,\x0A                cache: true,\x0A                success: function () {\x0A                    FT.$(\x27#ft-article-comments\x27)\x0A                        .css({\x27clear\x27: \x27both\x27, \x27padding-top\x27: \x2720px\x27})\x0A                        .append(\x27<div id=\x22livefyre-app-ft-\x27 + articleUUID + \x27\x22></div>\x27);\x0A            \x0A                    var commentsObj = commentsFtIntegration.init(FT.$);\x0A            \x0A                    var ftCommentsWidget = new commentsObj.Widget({\x0A                        elId: \x27livefyre-app-ft-\x27 + articleUUID,\x0A                        title: document.title,\x0A                        url: FT.$(\x27link[rel=canonical]\x27).attr(\x27href\x27) || document.location.href,\x0A                        articleId: articleUUID,\x0A                        authPageReload: true,\x0A                        stringOverrides: {\x0A                            commentCountLabel: \x27COMMENTS (%s)\x27,\x0A                            commentCountLabelPlural: \x27COMMENTS (%s)\x27\x0A                        }\x0A                    });\x0A            \x0A                    ftCommentsWidget.on(\x27initialRenderComplete.widget\x27, function () {\x0A                        ftCommentsWidget.ui.moveCommentCountOut();\x0A                    });\x0A                    ftCommentsWidget.on(\x27loginRequired.authAction.ft\x27, function () {\x0A                        FT.$(\x27html,body\x27).animate({\x0A                                scrollTop: 0\x0A                            }, \x27500\x27, \x27swing\x27, function () {\x0A                                FT.render.loginForm.open();\x0A                            });\x0A                    });\x0A                    ftCommentsWidget.deferredLoad();\x0A                }\x0A            });\x0A        }\x0A    });\x0A<\/script>",locationId:2,positionId:2,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},26202326:{id:"26202326",name:"FTBF_AUTHOR_ALERTS_FREQ",scriptTimeout:5000,pre:"",url:"",post:"",html:"<script type=\x22text/javascript\x22>\x0A  (function() {\x0A    \x0A    var addScript = function(src) {\x0A      var script = document.createElement(\x27script\x27);\x0A      script.type = \x27text/javascript\x27;\x0A      script.async = true;\x0A      script.src = src;\x0A      var scripts = document.getElementsByTagName(\x27script\x27);\x0A      scripts[scripts.length-1].parentNode.appendChild(script);\x0A    };\x0A    \x0A    if((\x27addEventListener\x27 in document) && (\x27querySelector\x27 in document)) {\x0A      addScript(\x27http://www.ft-static.com/sp/test/author_alerts/short/0.3.4/jsinclude.min.js\x27);\x0A    } else {\x0A      addScript(\x27http://www.ft-static.com/sp/prod/author_alerts/long/0.2.13/jsinclude.min.js\x27);\x0A    }\x0A  }());\x0A<\/script>",locationId:1,positionId:2,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},30255317:{id:"30255317",name:"Alphaville - Sentry",scriptTimeout:5000,pre:"",url:"cdn.ravenjs.com/1.1.15/jquery,native/raven.min.js",post:"",html:"",locationId:1,positionId:1,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},30340584:{id:"30340584",name:"Alphaville - Markets Live -addEventListener",scriptTimeout:5000,pre:"",url:"",post:"",html:"<script>\x0A  // addEventListener polyfill 1.0 / Eirik Backer / MIT Licence\x0A(function(win, doc){\x0A	if(win.addEventListener)return;		//No need to polyfill\x0A\x0A	function docHijack(p){var old = doc[p];doc[p] = function(v){return addListen(old(v))}}\x0A	function addEvent(on, fn, self){\x0A		return (self = this).attachEvent(\x27on\x27 + on, function(e){\x0A			var e = e || win.event;\x0A			e.preventDefault  = e.preventDefault  || function(){e.returnValue = false}\x0A			e.stopPropagation = e.stopPropagation || function(){e.cancelBubble = true}\x0A			fn.call(self, e);\x0A		});\x0A	}\x0A	function addListen(obj, i){\x0A		if(i = obj.length)while(i--)obj[i].addEventListener = addEvent;\x0A		else obj.addEventListener = addEvent;\x0A		return obj;\x0A	}\x0A\x0A	addListen([doc, win]);\x0A	if(\x27Element\x27 in win)win.Element.prototype.addEventListener = addEvent;			//IE8\x0A	else{																			//IE < 8\x0A		doc.attachEvent(\x27onreadystatechange\x27, function(){addListen(doc.all)});		//Make sure we also init at domReady\x0A		docHijack(\x27getElementsByTagName\x27);\x0A		docHijack(\x27getElementById\x27);\x0A		docHijack(\x27createElement\x27);\x0A		addListen(doc.all);	\x0A	}\x0A})(window, document);\x0A<\/script>",locationId:1,positionId:1,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]}};
var m=1;var k="pong.qubitproducts.com";var i="";var n=false;var j=300;(function(){var t=qubit.Tags,x=qubit.qtag.Utils,C=b.html.simplecookie,y=b.html.GlobalEval,v=b.html.fileLoader,E=b.html.HtmlInjector,D=function(){},r=function(){},A=function(){},z=new qubit.qtag.Ping(B),u=qubit.qtag.Session;n=n||!!window.otDelayDocWrite;function w(F){if(window.console&&window.console.log){console.log(F)}}function B(H,G,F){f=H||f;l=G||l;h=F||h;t.registerTag(B);window["__ot_vars__"+a]=h;b.html.UVListener.init();B.isSync=B.determineIfSync();B.setup(f,l)}B.getConfig=function(){return{containerName:c,qTagClientId:g,profileName:a,delayDocWrite:n,tellLoadTimesProbability:m,pingServerUrl:k,maxCookieLength:j,qtag_domain:i,filters:f,scriptLoaders:l,pageVars:h,async:!B.isSync,scriptURL:o}};B.setup=function(I,H){var G,K,J={};if(d){J=u.setupSession(B.getConfig())}B.docWriteUsers=[];B.errors={};B.loadersAwaitingConsent=[];B.isTellingLoadTimes=m>Math.random();if(B.isTellingLoadTimes){B.loadTimes={}}G=B.getFilterStates(I,x.getUrl(),J);for(var F in H){if(!H[F].scriptTimeout||H[F].scriptTimeout<0){H[F].scriptTimeout=B.TAG_MAX_WAIT}}B.qTagLoaders=B.getLoaders(G,H);B.qTagLoaderCount=0;B.loadTimesSent=false;B.loadersStarted=0;B.loadersFinished=0;B.initialLoadFinished=false;B.canCallLoaded=false;B.hasCalledLoaded=false;B.loadedSomeSync=false;B.runStarters(G,J);B.initialLoadFinished=true;B.waitingForSyncWrites=false;z.handleDedupe(B.qTagLoaders,B.getConfig());if(n){b.html.ready(function(){B.sequentiallyLoadingDelayed=false;B.loadLoadersSequentially()})}else{if(B.loadedSomeSync){setTimeout(B.loadLoadersSequentially,100)}else{B.loadLoadersSequentially()}b.html.ready(function(){B.loadLoadersSequentially()})}B.flushLoadTimes();if(B.canCallLoaded){B.callAllLoaded()}window.opentag_consentCBs=window.opentag_consentCBs||[];window.opentag_consentGiven=window.opentag_consentGiven||function(){var M,N,L;for(M=0,N=window.opentag_consentCBs.length;M<N;M+=1){window.opentag_consentCBs[M]()}};window.opentag_consentCBs.push(B.consentGiven)};B.ALL="1";B.SUBSTRING="2";B.REGEX="3";B.EXACT_MATCH="4";B.FN="100";B.DEDUPE_FN="110";B.FILTER_TYPE_INCLUDE="1";B.FILTER_TYPE_EXCLUDE="2";B.NORMAL_FILTER="1";B.DEDUPE_URL_FILTER="2";B.DEDUPE_SESSION_FILTER="3";B.JS_VALUE="2";B.QUERY_PARAM="3";B.COOKIE_VALUE="4";B.ELEMENT_VALUE="5";B.NOT_LOADED=0;B.LOADING=1;B.LOAD_FAILURE=2;B.LOAD_SUCCESS=3;B.determineIfSync=function(){var H,I,G,F,J;F=document.getElementsByTagName("script");for(H=0,I=F.length;H<I;H+=1){G=F[H];J=G.getAttribute("src");if(!!J&&(J.indexOf(""+g+"-"+a+".js")>0)){return(G.getAttribute("async")===null&&(G.getAttribute("defer")===false||G.getAttribute("defer")===""||G.getAttribute("defer")===null))}}return true};B.getFilterStates=function(H,F,J){var I,M,G,N={},K=[],L;if((!H)||(!F)){return K}for(I=0,M=H.length;I<M;I+=1){G=H[I];L=B.doesFilterMatch(G,F,J);if(L){K.push(G)}else{}}K.sort(function(P,O){return O.priority-P.priority});return K};B.getLoaders=function(J,K,G){var H,I,L={},F={};for(H=0,I=J.length;H<I;H+=1){B.updateLoaders(J[H],L)}for(H in L){if(L.hasOwnProperty(H)){F[H]=K[H];F[H].dedupe=L[H];F[H].state=B.NOT_LOADED;F[H].nextLoaders={}}}return F};B.updateLoaders=function(J,K){var G,I,H,F=J.scriptLoaderKeys;if(J.filterType===B.FILTER_TYPE_INCLUDE){for(G=0,I=F.length;G<I;G+=1){H=B.getFilterType(J);if((H===B.NORMAL_FILTER)||(H===B.DEDUPE_URL_FILTER)||(K[F[G]]===B.DEDUPE_URL_FILTER)){K[F[G]]=H}}}else{if(J.filterType===B.FILTER_TYPE_EXCLUDE){for(G=0,I=F.length;G<I;G+=1){delete K[F[G]]}}}};B.getFilterType=function(G){var F=parseInt(G.patternType,10);if((F<10)||(F===100)){return B.NORMAL_FILTER}if((F>=10)&&(F<20)){return B.DEDUPE_URL_FILTER}if(F===110){return B.DEDUPE_SESSION_FILTER}};B.runStarters=function(J,K){var G,I,H;for(G=0,I=J.length;G<I;G+=1){H=J[G];try{H.starter(K,B.createStarterCb(H))}catch(F){}}};B.createStarterCb=function(F){return function(J){var I,K,H,G=[],L;for(I=0,K=F.scriptLoaderKeys.length;I<K;I+=1){H=B.qTagLoaders[F.scriptLoaderKeys[I]];if(H&&J===true){if(H.state===B.LOAD_SUCCESS){H.state=B.NOT_LOADED;H.counted=false}else{}}if(H&&(H.state===B.NOT_LOADED)&&(H.dedupe!==B.DEDUPE_URL_FILTER)){if(!((H.dedupe===B.DEDUPE_SESSION_FILTER)&&(F.patternType!==B.DEDUPE_FN))){if(!H.counted){H.counted=true;G.push(H)}}}}for(I=0,K=G.length;I<K;I+=1){H=G[I];if(B.hasConsent()||!B.needsConsent(H)){B.loadLoader(H)}else{B.loadersAwaitingConsent.push(H)}}}};B.hasConsent=function(){return C.readCookie("qubitconsent")==="Accepted"};B.needsConsent=function(F){return !!F.needsConsent};B.consentGiven=function(){var G,H,F=B.loadersAwaitingConsent;for(G=0,H=F.length;G<H;G+=1){B.loadLoader(F[G])}};B.doesFilterMatch=function(G,F,J){var H=false;switch(G.patternType){case B.FN:case B.DEDUPE_FN:try{H=G.pattern(J)}catch(I){H=false}break;case B.EXACT_MATCH:case"1"+B.EXACT_MATCH:if(F.toLowerCase()===G.pattern.toLowerCase()){H=true}break;case B.SUBSTRING:case"1"+B.SUBSTRING:if(F.toLowerCase().indexOf(G.pattern.toLowerCase())>=0){H=true}break;case B.REGEX:case"1"+B.REGEX:if(new RegExp(G.pattern).test(F)){H=true}break;case B.ALL:case"1"+B.ALL:H=true;break}if(H&&!G.starter){G.starter=B.defaultStarter}return H};B.defaultStarter=function(G,F){F()};B.TAG_MAX_WAIT=10*1000;B.loadCheckInterval=500;B.loadLoader=function(G){var H,F;if((G.state===B.NOT_LOADED)&&B.dependenciesExist(G)){try{G.state=B.LOADING;G.startTime=new Date().valueOf();if(G.usesDocWrite&&!(B.isSync&&!G.async)){B.docWriteUsers.push(G);B.loadLoadersSequentially()}else{B.doWhenReady(G,B.loadTagLoader,function(){})}}catch(I){G.state=B.LOAD_FAILURE;H={reason:"error parsing loader, "+G.id+": "+I.reason,url:document.location.href};B.errors[G.id]=H;w(H)}}};B.dependenciesExist=function(F){var H,I,J,G,K=true;J=F.dependencies;if(!J){return true}for(H=0,I=J.length;H<I;H+=1){G=B.qTagLoaders[J[H]];if(!G){K=false}else{if(G.state!==B.LOAD_SUCCESS){G.nextLoaders[F.id]=true;K=false}else{}}}return K};function q(G,F){B.qTagLoaderCount+=1;F(G)}B.doWhenReady=function(G,F,H){if(B.canLoad(G)){q(G,F)}else{var I=new Date().valueOf()-G.startTime;if(I<G.scriptTimeout){setTimeout(function(){B.doWhenReady(G,F,H)},B.loadCheckInterval)}else{G.DONE_LOADING=true;if(B.canLoad(G,true)){q(G,F)}else{H(G)}}}};B.isPageVarsTimedOut=function(F){return F.scriptTimeout<(new Date().valueOf()-F.startTime)};B.canLoad=function(F,G){var H=B.elementExists(F)&&B.pageVariablesExist(h,F,G);return H};B.elementExists=function(F){if(B.isSync&&!F.async){return true}else{if(F.locationId===2){return !!document.body}else{if(F.locationId===3){return !!document.getElementById(F.locationDetail)}}}return true};B.pageVariablesExist=function(I,F,H){var G,J,K,M;if(!F.pageVars){return true}for(G in F.pageVars){if(F.pageVars.hasOwnProperty(G)){try{K=I[G];J=B.pageVariableExists(K,F,G,H);if(!J){return false}}catch(L){return false}}}return true};function s(F,H){var R,K,J,G,M,P,I,L=false;var O=F.type;var Q=F.value;switch(O){case B.JS_VALUE:try{if(Q.indexOf("[#]")===-1){y.globalEval("window.__var_test = ("+Q+")");I=window.__var_test}else{I=B.getArrayPageVariableExists(F);if(I){y.globalEval("window.__var_test = ("+I+")");I=window.__var_test;L=true}}}catch(N){I=null}break;case B.QUERY_PARAM:I=x.getQueryParam(Q);break;case B.COOKIE_VALUE:I=C.readCookie(Q);break;case B.ELEMENT_VALUE:I=x.getElementValue(Q);break}return{pageValue:I,isArray:L}}B.pageVariableExists=function(K,F,G,H){var J=s(K,F);var I=x.variableExists(J.pageValue);if(I){K.pageValue=J.pageValue;K.isArray=J.isArray}else{if(H){I=x.variableExists(F.pageVars[G].defaultValue)}}return I};B.getArrayPageVariableExists=function(F){var G,M,K,L,J,N,H;L=true;J=false;N="";H=F.value.split("[#]");for(G=0,M=H.length-1;L&&(G<M);G+=1){N+=H[G];try{y.globalEval("window.__var_test = ("+N+")");K=window.__var_test}catch(I){L=false}L=L&&x.variableExists(K);if(L){if(K.length===0){J=true;break}N+="[0]"}}if(!L){return null}else{if(J){return N}else{return F.value.replace("[#]","[0]")}}};B.loadingSequentially=false;B.waitingForSyncWrites=true;B.sequentiallyLoadingDelayed=n;B.loadLoadersSequentially=function(){var G,H,I,F;
if(!B.waitingForSyncWrites&&!B.sequentiallyLoadingDelayed&&!B.loadingSequentially&&(B.docWriteUsers.length>0)){B.loadingSequentially=true;F=false;for(H=0,I=B.docWriteUsers.length;H<I;H+=1){G=B.docWriteUsers[H];if(B.canLoad(G)){B.docWriteUsers.splice(H,1);F=true;break}else{}}if(F){B.doWhenReady(G,B.loadLoaderSequentially,function(){B.loadLoadersSequentially()})}else{B.loadingSequentially=false}}else{}};B.loadLoaderSequentially=function(G){var I=[],H,F;document.write=function(J){I.push(J)};document.writeln=function(J){I.push(J)};H=function(){var J=B.getLocation(G);E.inject(J,G.positionId===1,I.join("\n"),function(){})};G.finishHandler=H;B.loadTagLoader(G)};B.loadTagLoader=function(F){B.substituteValues(h,F);var G=B.getTimerEnder(F);try{if(F.url){if(!F.async&&B.isSync){B.loadTagLoaderSync(F)}else{v.load(F.url,B.getTimerStarter(F),G,F.parentNode,F.async)}}else{if(F.html){B.injectHtml(F)}}}catch(H){G(null,H,true)}};B.substituteValues=function(G,F){B._substituteValues(G,F,"html");B._substituteValues(G,F,"pre");B._substituteValues(G,F,"post");B._substituteValues(G,F,"url")};B._substituteValues=function(K,H,O){var G,J,I,F="_"+O,M,P;if(!H[F]){H[F]=H[O]}M=H[F];if(M&&M.length>0){for(J in H.pageVars){if(H.pageVars.hasOwnProperty(J)){G=K[J];I="\\${"+H.pageVars[J].token+"}";var L=G.pageValue;if(G.pageValue===undefined){L=t.getVariableValue(a,H.id,J)}if(G.isArray){M=x.substituteArray(G,I,M)}else{if(L instanceof Array){var N="qubit.Tags.getVariableValue("+a+","+H.id+","+J+")";M=M.replace(new RegExp(I,"g"),N)}else{L=L;M=M.replace(new RegExp(I,"g"),L)}}}}H[O]=M}};B.loadTagLoaderSync=function(F){var G,I="scr",H;B.getTimerStarter(F)();G=v.tidyUrl(F.url);H="<"+I+"ipt type='text/javascript' src='"+G+"'></"+I+"ipt>";document.write(H);B.loadedSomeSync=true;B.getTimerEnder(F)()};B.injectHtml=function(F){var G=B.getLocation(F);B.getTimerStarter(F)();E.inject(G,F.positionId===1,F.html,B.getTimerEnder(F))};B.getLocation=function(F){var G;if(F.locationId===1){G=document.getElementsByTagName("head")[0]}else{if(F.locationId===2){G=document.body}else{if(F.locationId===3){G=document.getElementById(F.locationDetail)}else{G=document.body}}}return G};B.getTimerStarter=function(F){var G;if(B.isTellingLoadTimes){G=(new Date()).getTime();B.loadTimes[F.id]={start:G}}return B.createStatementEvaluator(F.url?F.pre:"",true)};B.getTimerEnder=function(G){var H=false,F;return function(K,J,L){if(H){return}H=true;try{var N,I,O;if(B.isTellingLoadTimes){I=(new Date()).getTime();B.loadTimes[G.id].end=I}if(G.finishHandler){G.finishHandler()}B.createStatementEvaluator((!L&&!!G.url)?G.post:"",false)();if(J){B.errors[G.id]=J;G.state=B.LOAD_FAILURE}else{G.state=B.LOAD_SUCCESS}if(B.loadingSequentially){B.loadingSequentially=false}B.loadLoadersSequentially();if(!L){B.loadDependentScripts(G)}}catch(M){w(M)}}};B.loadDependentScripts=function(F){var G;for(G in F.nextLoaders){if(F.nextLoaders.hasOwnProperty(G)){if(B.qTagLoaders[G]){B.loadLoader(B.qTagLoaders[G])}}}};B.createStatementEvaluator=function(F,G){if((!!F)&&(F.length>0)){return function(){B.incrementLoadCounter(G);y.globalEval(F)}}else{return function(){B.incrementLoadCounter(G)}}};B.incrementLoadCounter=function(F){if(F){B.loadersStarted+=1;B.canCallLoaded=false}else{B.loadersFinished+=1}B.flushLoadTimes()};B.flushLoadTimes=function(){if((B.initialLoadFinished&&(B.loadersFinished===B.qTagLoaderCount))||(B.loadTimesSent&&(B.loadersStarted===B.loadersFinished))){z.sendLoadTimes(B.getConfig());B.canCallLoaded=true;if(B.initialLoadFinished){B.callAllLoaded()}B.loadTimesSent=true}};B.callAllLoaded=function(){if(!B.hasCalledLoaded){B.hasCalledLoaded=true;if(window.qTag_allLoaded){window.qTag_allLoaded()}}};B.isDebugMode=function(){var F=false;if(C.readCookie("opentag_debug")||C.readCookie("opentag_debug_tool")||document.location.href.indexOf("opentag_debug")>=0){F=true}return F};B.start=function(){if(B.STARTED){return}B.STARTED=true;if(B.isDebugMode()){var F=document.createElement("script");if(o){F.src=o}else{F.src="//s3-eu-west-1.amazonaws.com/opentag/opentag-"+g+"-"+a+"-debug.js"}document.getElementsByTagName("head")[0].appendChild(F)}else{var G=function(){var H=new B(f,l,h)};G()}};B.start()}())}())}catch(e){try{if(window.debug){console.log(e)}}catch(ex){}};